
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Just write something about Workã€Technology and Life.">
      
      
        <meta name="author" content="shafish">
      
      
        <link rel="canonical" href="https://shafish.cn/blog/2021/12/nginx_record/">
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.3">
    
    
      
        <title>nginxä½¿ç”¨è®°å½• - shafish.cn</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.edf004c2.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/vssue.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nginxä½¿ç”¨è®°å½•" class="md-skip">
          è·³è½¬è‡³
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰">
    <a href="../../../.." title="shafish.cn" class="md-header__button md-logo" aria-label="shafish.cn" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            shafish.cn
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              nginxä½¿ç”¨è®°å½•
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="æœç´¢" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="æŸ¥æ‰¾">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="æ¸…ç©ºå½“å‰å†…å®¹" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/shafishcn/shafish_blog/" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    shafishcn/shafish_blog
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="æ ‡ç­¾" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../" class="md-tabs__link md-tabs__link--active">
        æŠ€æœ¯
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../life/" class="md-tabs__link">
      ç”Ÿæ´»
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../about/" class="md-tabs__link">
      å…³äº
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="å¯¼èˆªæ " data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="shafish.cn" class="md-nav__button md-logo" aria-label="shafish.cn" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    shafish.cn
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/shafishcn/shafish_blog/" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    shafishcn/shafish_blog
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../">æŠ€æœ¯</a>
          
            <label for="__nav_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="æŠ€æœ¯" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          æŠ€æœ¯
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2" type="checkbox" id="__nav_1_2" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_2">
          ä¼šæ›´æ–°åŒº
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ä¼šæ›´æ–°åŒº" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_2">
          <span class="md-nav__icon md-icon"></span>
          ä¼šæ›´æ–°åŒº
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../mkdocs/" class="md-nav__link">
        mkdocsä½¿ç”¨è®°å½•
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../i3wm/" class="md-nav__link">
        i3wmä½¿ç”¨è®°å½•
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_3" type="checkbox" id="__nav_1_3" checked>
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../">2021å¹´</a>
          
            <label for="__nav_1_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="2021å¹´" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_3">
          <span class="md-nav__icon md-icon"></span>
          2021å¹´
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_3_2" type="checkbox" id="__nav_1_3_2" checked>
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_1_3_2">
          12æœˆä»½
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="12æœˆä»½" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_3_2">
          <span class="md-nav__icon md-icon"></span>
          12æœˆä»½
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../archivebox/" class="md-nav__link">
        archiveboxä½¿ç”¨
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jenkins/" class="md-nav__link">
        jenkinséƒ¨ç½²
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../github_action/" class="md-nav__link">
        github actionä½¿ç”¨
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          nginxä½¿ç”¨è®°å½•
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        nginxä½¿ç”¨è®°å½•
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ä¸€å®‰è£…ä¾èµ–åº“" class="md-nav__link">
    ä¸€ã€å®‰è£…ä¾èµ–åº“
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#äºŒconfigureé…ç½®" class="md-nav__link">
    äºŒã€configureé…ç½®
  </a>
  
    <nav class="md-nav" aria-label="äºŒã€configureé…ç½®">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1è·¯å¾„ç›¸å…³å‚æ•°" class="md-nav__link">
    1.è·¯å¾„ç›¸å…³å‚æ•°ï¼š
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2ç¼–è¯‘ç›¸å…³å‚æ•°" class="md-nav__link">
    2.ç¼–è¯‘ç›¸å…³å‚æ•°ï¼š
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3ç›¸å…³å¸¸ç”¨è½¯ä»¶åº“é…ç½®å‚æ•°" class="md-nav__link">
    3.ç›¸å…³ï¼ˆå¸¸ç”¨ï¼‰è½¯ä»¶åº“é…ç½®å‚æ•°ï¼š
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4æ¨¡å—ç›¸å…³å‚æ•°åˆåˆ†ä¸ºäº”å¤§æ¨¡å—" class="md-nav__link">
    4.æ¨¡å—ç›¸å…³å‚æ•°ï¼šåˆåˆ†ä¸ºäº”å¤§æ¨¡å—
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ä¸‰ç¼–è¯‘å®‰è£…" class="md-nav__link">
    ä¸‰ã€ç¼–è¯‘å®‰è£…
  </a>
  
    <nav class="md-nav" aria-label="ä¸‰ã€ç¼–è¯‘å®‰è£…">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ç¤ºä¾‹a" class="md-nav__link">
    ç¤ºä¾‹a
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ç¤ºä¾‹b" class="md-nav__link">
    ç¤ºä¾‹b
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ç¤ºä¾‹c" class="md-nav__link">
    ç¤ºä¾‹c
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#å››ä¸ºå·²å®‰è£…çš„nginxåŠ¨æ€æ·»åŠ æ¨¡å—" class="md-nav__link">
    å››ã€ä¸ºå·²å®‰è£…çš„NginxåŠ¨æ€æ·»åŠ æ¨¡å—
  </a>
  
    <nav class="md-nav" aria-label="å››ã€ä¸ºå·²å®‰è£…çš„NginxåŠ¨æ€æ·»åŠ æ¨¡å—">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#åŠ ngx_http_google_filter_module" class="md-nav__link">
    åŠ ngx_http_google_filter_module
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#äº”nginxå‘½ä»¤" class="md-nav__link">
    äº”ã€nginxå‘½ä»¤
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#å…­nginxåŸºæœ¬çš„é…ç½®" class="md-nav__link">
    å…­ã€nginxåŸºæœ¬çš„é…ç½®
  </a>
  
    <nav class="md-nav" aria-label="å…­ã€nginxåŸºæœ¬çš„é…ç½®">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1ç”¨äºè°ƒè¯•é—®é¢˜å®šä½çš„é…ç½®" class="md-nav__link">
    1.ç”¨äºè°ƒè¯•ã€é—®é¢˜å®šä½çš„é…ç½®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2è¿è¡Œå¿…å¤‡é…ç½®" class="md-nav__link">
    2.è¿è¡Œå¿…å¤‡é…ç½®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3æ€§èƒ½ä¼˜åŒ–é…ç½®" class="md-nav__link">
    3.æ€§èƒ½ä¼˜åŒ–é…ç½®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4äº‹ä»¶ç±»å‹é…ç½®" class="md-nav__link">
    4.äº‹ä»¶ç±»å‹é…ç½®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ä¸ƒnginx-httpæ¨¡å—é…ç½®" class="md-nav__link">
    ä¸ƒã€nginx httpæ¨¡å—é…ç½®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1æ¨¡å—å˜é‡" class="md-nav__link">
    1.æ¨¡å—å˜é‡
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2è™šæ‹Ÿä¸»æœºä¸è¯·æ±‚çš„åˆ†å‘" class="md-nav__link">
    2.è™šæ‹Ÿä¸»æœºä¸è¯·æ±‚çš„åˆ†å‘
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3æ–‡ä»¶è·¯å¾„çš„å®šä¹‰" class="md-nav__link">
    3.æ–‡ä»¶è·¯å¾„çš„å®šä¹‰
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4å†…å­˜åŠç£ç›˜èµ„æºçš„åˆ†é…" class="md-nav__link">
    4.å†…å­˜åŠç£ç›˜èµ„æºçš„åˆ†é…
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5ç½‘ç»œè¿æ¥çš„è®¾ç½®" class="md-nav__link">
    5.ç½‘ç»œè¿æ¥çš„è®¾ç½®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6mimeç±»å‹çš„è®¾ç½®" class="md-nav__link">
    6.MIMEç±»å‹çš„è®¾ç½®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7å¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„é™åˆ¶" class="md-nav__link">
    7.å¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„é™åˆ¶
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8æ–‡ä»¶æ“ä½œçš„ä¼˜åŒ–" class="md-nav__link">
    8.æ–‡ä»¶æ“ä½œçš„ä¼˜åŒ–
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9å¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„ç‰¹æ®Šå¤„ç†" class="md-nav__link">
    9.å¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„ç‰¹æ®Šå¤„ç†
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../life/" class="md-nav__link">
        ç”Ÿæ´»
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/" class="md-nav__link">
        å…³äº
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ä¸€å®‰è£…ä¾èµ–åº“" class="md-nav__link">
    ä¸€ã€å®‰è£…ä¾èµ–åº“
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#äºŒconfigureé…ç½®" class="md-nav__link">
    äºŒã€configureé…ç½®
  </a>
  
    <nav class="md-nav" aria-label="äºŒã€configureé…ç½®">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1è·¯å¾„ç›¸å…³å‚æ•°" class="md-nav__link">
    1.è·¯å¾„ç›¸å…³å‚æ•°ï¼š
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2ç¼–è¯‘ç›¸å…³å‚æ•°" class="md-nav__link">
    2.ç¼–è¯‘ç›¸å…³å‚æ•°ï¼š
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3ç›¸å…³å¸¸ç”¨è½¯ä»¶åº“é…ç½®å‚æ•°" class="md-nav__link">
    3.ç›¸å…³ï¼ˆå¸¸ç”¨ï¼‰è½¯ä»¶åº“é…ç½®å‚æ•°ï¼š
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4æ¨¡å—ç›¸å…³å‚æ•°åˆåˆ†ä¸ºäº”å¤§æ¨¡å—" class="md-nav__link">
    4.æ¨¡å—ç›¸å…³å‚æ•°ï¼šåˆåˆ†ä¸ºäº”å¤§æ¨¡å—
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ä¸‰ç¼–è¯‘å®‰è£…" class="md-nav__link">
    ä¸‰ã€ç¼–è¯‘å®‰è£…
  </a>
  
    <nav class="md-nav" aria-label="ä¸‰ã€ç¼–è¯‘å®‰è£…">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ç¤ºä¾‹a" class="md-nav__link">
    ç¤ºä¾‹a
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ç¤ºä¾‹b" class="md-nav__link">
    ç¤ºä¾‹b
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ç¤ºä¾‹c" class="md-nav__link">
    ç¤ºä¾‹c
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#å››ä¸ºå·²å®‰è£…çš„nginxåŠ¨æ€æ·»åŠ æ¨¡å—" class="md-nav__link">
    å››ã€ä¸ºå·²å®‰è£…çš„NginxåŠ¨æ€æ·»åŠ æ¨¡å—
  </a>
  
    <nav class="md-nav" aria-label="å››ã€ä¸ºå·²å®‰è£…çš„NginxåŠ¨æ€æ·»åŠ æ¨¡å—">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#åŠ ngx_http_google_filter_module" class="md-nav__link">
    åŠ ngx_http_google_filter_module
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#äº”nginxå‘½ä»¤" class="md-nav__link">
    äº”ã€nginxå‘½ä»¤
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#å…­nginxåŸºæœ¬çš„é…ç½®" class="md-nav__link">
    å…­ã€nginxåŸºæœ¬çš„é…ç½®
  </a>
  
    <nav class="md-nav" aria-label="å…­ã€nginxåŸºæœ¬çš„é…ç½®">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1ç”¨äºè°ƒè¯•é—®é¢˜å®šä½çš„é…ç½®" class="md-nav__link">
    1.ç”¨äºè°ƒè¯•ã€é—®é¢˜å®šä½çš„é…ç½®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2è¿è¡Œå¿…å¤‡é…ç½®" class="md-nav__link">
    2.è¿è¡Œå¿…å¤‡é…ç½®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3æ€§èƒ½ä¼˜åŒ–é…ç½®" class="md-nav__link">
    3.æ€§èƒ½ä¼˜åŒ–é…ç½®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4äº‹ä»¶ç±»å‹é…ç½®" class="md-nav__link">
    4.äº‹ä»¶ç±»å‹é…ç½®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ä¸ƒnginx-httpæ¨¡å—é…ç½®" class="md-nav__link">
    ä¸ƒã€nginx httpæ¨¡å—é…ç½®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1æ¨¡å—å˜é‡" class="md-nav__link">
    1.æ¨¡å—å˜é‡
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2è™šæ‹Ÿä¸»æœºä¸è¯·æ±‚çš„åˆ†å‘" class="md-nav__link">
    2.è™šæ‹Ÿä¸»æœºä¸è¯·æ±‚çš„åˆ†å‘
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3æ–‡ä»¶è·¯å¾„çš„å®šä¹‰" class="md-nav__link">
    3.æ–‡ä»¶è·¯å¾„çš„å®šä¹‰
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4å†…å­˜åŠç£ç›˜èµ„æºçš„åˆ†é…" class="md-nav__link">
    4.å†…å­˜åŠç£ç›˜èµ„æºçš„åˆ†é…
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5ç½‘ç»œè¿æ¥çš„è®¾ç½®" class="md-nav__link">
    5.ç½‘ç»œè¿æ¥çš„è®¾ç½®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6mimeç±»å‹çš„è®¾ç½®" class="md-nav__link">
    6.MIMEç±»å‹çš„è®¾ç½®
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7å¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„é™åˆ¶" class="md-nav__link">
    7.å¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„é™åˆ¶
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8æ–‡ä»¶æ“ä½œçš„ä¼˜åŒ–" class="md-nav__link">
    8.æ–‡ä»¶æ“ä½œçš„ä¼˜åŒ–
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9å¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„ç‰¹æ®Šå¤„ç†" class="md-nav__link">
    9.å¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„ç‰¹æ®Šå¤„ç†
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                <!--
  Copyright (c) 2016-2021 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Edit button -->

<a
  href="https://github.com/shafishcn/shafish_blog/edit/main/docs/blog/2021/12/nginx_record.md"
  title="ç¼–è¾‘æ­¤é¡µ"
  class="md-content__button md-icon"
>
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<!--
  Hack: check whether the content contains a h1 headline. If it
  doesn't, the page title (or respectively site name) is used
  as the main headline.
-->


<!-- Markdown content -->
<h1 id="nginxä½¿ç”¨è®°å½•">nginxä½¿ç”¨è®°å½•<a class="headerlink" href="#nginxä½¿ç”¨è®°å½•" title="Permanent link">ğŸŸ</a></h1>
<details class="abstract" open="open">
<summary>Abstract</summary>
<p>ä»…åšç¬”è®°ï¼Œä¸ºäº†æœ‰ä¸ªå°å°å°è±¡ã€‚</p>
</details>
<h2 id="ä¸€å®‰è£…ä¾èµ–åº“">ä¸€ã€å®‰è£…ä¾èµ–åº“<a class="headerlink" href="#ä¸€å®‰è£…ä¾èµ–åº“" title="Permanent link">ğŸŸ</a></h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>sudo pacman -S wget gcc-c++ ncurses ncurses-devel cmake make perl bison openssl openssl-devel <span class="se">\</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>gcc* libxml2 libxml2-devel curl-devel libjpeg* libpng* freetype* autoconf automake zlib* fiex* <span class="se">\</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>libxml* libmcrypt* libtool-ltdl-devel* libaio libaio-devel bzr libtool
</code></pre></div>
<h2 id="äºŒconfigureé…ç½®">äºŒã€configureé…ç½®<a class="headerlink" href="#äºŒconfigureé…ç½®" title="Permanent link">ğŸŸ</a></h2>
<p>ä½¿ç”¨<code>configure</code>æŒ‡å®šé…ç½®é¡¹ï¼Œå¯ä»¥ç”¨<code>./configure --help</code>æŸ¥çœ‹ï¼Œå¯¹åº”å‚æ•°åˆ†ä¸ºå››å¤§ç±»ï¼š</p>
<h3 id="1è·¯å¾„ç›¸å…³å‚æ•°">1.è·¯å¾„ç›¸å…³å‚æ•°ï¼š<a class="headerlink" href="#1è·¯å¾„ç›¸å…³å‚æ•°" title="Permanent link">ğŸŸ</a></h3>
<ul>
<li><code>--prefix=path</code>ï¼šå®‰è£…çš„æ ¹ç›®å½•ï¼Œç¼ºçœé»˜è®¤ç›®å½•ä¸ºï¼š<code>/usr/local/nginx</code>ï¼Œè¯¥ç›®å½•æŒ‡ä¸‹é¢å‡ºç°åˆ°çš„<prefix>ï¼Œbulingbulingã€‚</li>
<li><code>--sbin-path=path</code>ï¼šnginxç›¸å…³äºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„ï¼Œ<code>&lt;prefix&gt;/sbin/nginx</code></li>
<li><code>--conf-path=path</code>ï¼šnginxé…ç½®æ–‡ä»¶è·¯å¾„ï¼Œ<code>&lt;prefix&gt;/conf/nginx.conf</code></li>
<li><code>--error-log-path=PATH</code>ï¼šerroræ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œ<code>&lt;prefix&gt;/logs/error.log</code></li>
<li><code>--pid-path=PATH</code>ï¼špidæ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ï¼Œæ–‡ä»¶ä»¥asciiç å­˜æ”¾nginx masterè¿›ç¨‹idï¼Œmasterä¹‹åä¼šè®²åˆ°ï¼ˆéå¸¸é‡è¦ï¼‰ï¼Œ<code>&lt;prefix&gt;/logs/nginx.pid</code></li>
<li><code>--lock-path=PATH</code>ï¼šlockæ–‡ä»¶çš„å­˜æ”¾è·¯å¾„ï¼Œ<code>&lt;prefix&gt;/logs/nginx.lock</code></li>
<li><code>--builddir=DIR</code>ï¼šconfiguraå‘½ä»¤æ‰§è¡Œå’Œç¨‹åºç¼–è¯‘æ—¶äº§ç”Ÿä¸´æ—¶æ–‡ä»¶çš„å­˜æ”¾ç›®å½•ï¼Œ<code>&lt;prefix&gt;/objs</code></li>
<li><code>--with-perl_modules_path=PATH</code>ï¼šperl moduleå­˜æ”¾è·¯å¾„</li>
<li><code>--with-perl=PATH</code>ï¼šperl binaryå­˜æ”¾è·¯å¾„ï¼Œæ‰§è¡Œperlè„šæœ¬éœ€è¦æ­¤è®¾ç½®</li>
<li><code>--http-log-path=PATH</code>ï¼šaccessæ—¥å¿—å­˜æ”¾è·¯å¾„ï¼Œä¼šè®°å½•æ¯ä¸ªhttpè¯·æ±‚çš„è®¿é—®è®°å½•ï¼Œ<code>&lt;prefix&gt;/logs/access.log</code></li>
<li><code>--http-client-body-temp-path=PATH</code>ï¼šä¿å­˜httpè¯·æ±‚åŒ…ä½“ç­‰ä¸´æ—¶å†…å®¹ï¼Œ<code>&lt;prefix&gt;/client_body_temp</code></li>
<li><code>--http-proxy-temp-path=PATH</code>ï¼šåšåå‘ä»£ç†æ—¶ï¼Œä¸Šæ¸¸æœåŠ¡å™¨çš„httpè¯·æ±‚åŒ…ä½“ï¼Œ<code>&lt;prefix&gt;/proxy_temp</code></li>
<li><code>--http-fastcgi-temp-path=PATH</code>ï¼šfastcgiä¸´æ—¶æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼Œ<code>&lt;prefix&gt;/fastcgi_temp</code></li>
<li><code>--http-uwsgi-temp-path=PATH</code>ï¼šuwsgiä¸´æ—¶æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼Œ<code>&lt;prefix&gt;/uwsgi_temp</code></li>
<li><code>--http-scgi-temp-path=PATH</code>ï¼šscgiä¸´æ—¶æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼Œ<code>&lt;prefix&gt;/scgi_temp</code></li>
</ul>
<h3 id="2ç¼–è¯‘ç›¸å…³å‚æ•°">2.ç¼–è¯‘ç›¸å…³å‚æ•°ï¼š<a class="headerlink" href="#2ç¼–è¯‘ç›¸å…³å‚æ•°" title="Permanent link">ğŸŸ</a></h3>
<ul>
<li><code>--with-cc=PATH</code>ï¼šcç¼–è¯‘å™¨çš„è·¯å¾„</li>
<li><code>--with-cpp=PATH</code>ï¼šcé¢„ç¼–è¯‘å™¨çš„è·¯å¾„</li>
<li><code>--with-cc-opt=OPTIONS</code>ï¼šåœ¨nginxç¼–è¯‘æ—¶æŒ‡å®šä¸€äº›ç¼–è¯‘é€‰é¡¹</li>
<li><code>--with-ld-opt=OPTIONS</code>ï¼šåŠ å…¥ç”ŸæˆäºŒè¿›åˆ¶æ‰§è¡Œæ–‡ä»¶å‰çš„ä¸€äº›æŒ‡å®šçš„é“¾æ¥æ–‡ä»¶</li>
<li><code>--with-cpu-opt=CPU</code>ï¼šæŒ‡å®šcpuå¤„ç†å™¨æ¶æ„ï¼Œpentium, pentiumpro, pentium3, pentium4, athlon, opteron, amd64, sparc32, sparc64, ppc64</li>
</ul>
<h3 id="3ç›¸å…³å¸¸ç”¨è½¯ä»¶åº“é…ç½®å‚æ•°">3.ç›¸å…³ï¼ˆå¸¸ç”¨ï¼‰è½¯ä»¶åº“é…ç½®å‚æ•°ï¼š<a class="headerlink" href="#3ç›¸å…³å¸¸ç”¨è½¯ä»¶åº“é…ç½®å‚æ•°" title="Permanent link">ğŸŸ</a></h3>
<ul>
<li>pcreåº“<ul>
<li><code>--without-pcre</code>ï¼šè®¾ç½®é…ç½®æ–‡ä»¶ä¸­ä¸ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼</li>
<li><code>--with-pcre</code>ï¼šå¼ºåˆ¶ä½¿ç”¨pcreåº“</li>
<li><code>--with-pcre=DIR</code>ï¼šæŒ‡å®špcreåº“çš„æºç ç›®å½•ï¼Œç¼–è¯‘nginxæ—¶è¿›å…¥è¯¥ç›®å½•ç¼–è¯‘pcre</li>
<li><code>--with-pcre-opt=OPTIONS</code>ï¼šç¼–è¯‘pcreæ—¶æŒ‡å®šç¼–è¯‘é€‰é¡¹</li>
</ul>
</li>
<li>opensslåº“<ul>
<li><code>--with-openssl=DIR</code>ï¼šæŒ‡å®šopensslåº“çš„æºç ç›®å½•ï¼Œç¼–è¯‘nginxæ—¶è¿›å…¥è¯¥ç›®å½•ç¼–è¯‘opensslã€‚å¦‚éœ€è¦httpsæ”¯æŒï¼Œéœ€è¦å®‰è£…è¯¥åº“</li>
<li><code>--with-openssl-opt=OPTIONS</code>ï¼šç¼–è¯‘opensslæ—¶æŒ‡å®šç¼–è¯‘é€‰é¡¹</li>
</ul>
</li>
<li>atomicåŸå­åº“<ul>
<li><code>--with-libatomic</code>ï¼šå¼ºåˆ¶ä½¿ç”¨atomicåº“</li>
<li><code>--with-libatomic=DIR</code>ï¼šatomicåº“æ‰€åœ¨ä½ç½®</li>
</ul>
</li>
<li>æ•£åˆ—å‡½æ•°åº“<ul>
<li><code>--with-MD5=DIR</code>ï¼šæŒ‡å®šmd5åº“æºç ç›®å½•ï¼Œç¼–è¯‘nginxæ—¶è¿›å…¥è¯¥ç›®å½•ç¼–è¯‘md5ã€‚ï¼ˆæ²¡ç‰¹æ®Šéœ€æ±‚ï¼Œå¯ç”¨nginxè‡ªå¸¦çš„md5ç®—æ³•ï¼‰</li>
<li><code>--with-MD5-opt=OPTIONS</code>ï¼šç¼–è¯‘md5æ—¶æŒ‡å®šç¼–è¯‘é€‰é¡¹</li>
<li><code>--with-MD5-asm</code>ï¼šä½¿ç”¨md5çš„æ±‡ç¼–æºç </li>
<li><code>--with-SHA1=DIR</code>ï¼šæŒ‡å®šSHA1åº“æºç ç›®å½•ï¼Œç¼–è¯‘nginxæ—¶è¿›å…¥è¯¥ç›®å½•ç¼–è¯‘SHA1ã€‚ï¼ˆopensslæœ‰sha1çš„å®ç°ï¼Œå·²ç»å®‰è£…opensslç›´æ¥ç”¨ï¼‰</li>
<li><code>--with-SHA1-opt=OPTIONS</code>ï¼šç¼–è¯‘SHA1æ—¶æŒ‡å®šç¼–è¯‘é€‰é¡¹</li>
<li><code>--with-SHA1-asm</code>ï¼šä½¿ç”¨SHA1çš„æ±‡ç¼–æºç </li>
</ul>
</li>
<li>zlibåº“<ul>
<li><code>--with-zlib=DIR</code>ï¼šæŒ‡å®šzlibåº“æºç ç›®å½•ï¼Œç¼–è¯‘nginxæ—¶è¿›å…¥è¯¥ç›®å½•ç¼–è¯‘zlibã€‚ï¼ˆéœ€è¦gzipå‹ç¼©ï¼Œå°±éœ€è¯¥åº“æ”¯æŒï¼‰</li>
<li><code>--with-zlib-opt=OPTIONS</code>ï¼šç¼–è¯‘zlibæ—¶æŒ‡å®šç¼–è¯‘é€‰é¡¹</li>
<li><code>--with-zlib-asm=CPU</code>ï¼šæŒ‡å®šå¯¹ç‰¹å®šcpuèŒä¸šzlibæ±‡ç¼–ä¼˜åŒ–åŠŸèƒ½ï¼Œpentium, pentiumproã€‚</li>
</ul>
</li>
<li>ã€‚ã€‚ã€‚</li>
</ul>
<h3 id="4æ¨¡å—ç›¸å…³å‚æ•°åˆåˆ†ä¸ºäº”å¤§æ¨¡å—">4.æ¨¡å—ç›¸å…³å‚æ•°ï¼šåˆåˆ†ä¸ºäº”å¤§æ¨¡å—<a class="headerlink" href="#4æ¨¡å—ç›¸å…³å‚æ•°åˆåˆ†ä¸ºäº”å¤§æ¨¡å—" title="Permanent link">ğŸŸ</a></h3>
<ul>
<li>äº‹ä»¶æ¨¡å—ï¼ˆå…·ä½“äº‹ä»¶é©±åŠ¨ç‰¹ç‚¹ï¼Œå¦è¯´ï¼‰<ul>
<li><code>--with-rtsig_module</code>ï¼šä½¿ç”¨rtsig moduleå¤„ç†äº‹ä»¶é©±åŠ¨</li>
<li><code>--with-select_module</code>ï¼šä½¿ç”¨select å¤šè·¯å¤ç”¨moduleå¤„ç†äº‹ä»¶æ¸ é“</li>
<li><code>--without-select_module</code>ï¼šä¸å®‰è£…select module</li>
<li><code>--with-poll_module</code>ï¼šä½¿ç”¨poll moduleå¤„ç†äº‹ä»¶é©±åŠ¨</li>
<li><code>--without-poll_module</code>ï¼šä¸å®‰è£…poll module</li>
<li><code>--with-aio_module</code>ï¼šä½¿ç”¨aioå¤„ç†äº‹ä»¶é©±åŠ¨ï¼Œåªèƒ½å†freebsdç³»ç»Ÿä¸­ä½¿ç”¨</li>
</ul>
</li>
<li>é»˜è®¤å®‰è£…è¿›httpæ¨¡å—ï¼ˆnginxå®‰è£…æ—¶é»˜è®¤å®‰è£…çš„httpç›¸å…³åŠŸèƒ½ï¼Œå¦‚æœä¸éœ€è¦å°±ç”¨<code>--without-http-xxx</code>å»é™¤ï¼‰<ul>
<li><code>--without-http_chatset_module</code>ï¼šä¸å®‰è£…http chatsetæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥å°†æœåŠ¡å™¨å‘å‡ºçš„httpå“åº”é‡ç¼–ç </li>
<li><code>--without-http_gzip_module</code>ï¼šä¸å®‰è£…gzipæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥å¯¹å“åº”å†…å®¹è¿›è¡Œå‹ç¼©</li>
<li><code>--without-http_ssi_module</code>ï¼šä¸å®‰è£…ssiæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥åœ¨å“åº”ä¸­åŠ å…¥ç‰¹å®šå†…å®¹</li>
<li><code>--without-http_userid_module</code>ï¼šä¸å®‰è£…useridæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥æ ¹æ®è¯·æ±‚å¤´çš„å­—æ®µä¿¡æ¯è¿›è¡Œç”¨æˆ·è®¤è¯ï¼Œç¡®å®šè¯·æ±‚æ˜¯å¦åˆæ³•</li>
<li><code>--without-http_access_module</code>ï¼šä¸å®‰è£…accessæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥æ ¹æ®ipæ˜¾ç¤ºå®¢æˆ·ç«¯è®¿é—®</li>
<li><code>--without-http_auth_basic_module</code>ï¼šä¸å®‰è£…auth basicæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥æé«˜ç®€å•çš„ç”¨æˆ·åã€å¯†ç è®¤è¯</li>
<li><code>--without-http_autoindex_module</code>ï¼šä¸å®‰è£…autoindexæ¨¡å—ï¼Œæ¨¡å—æä¾›ç®€å•çš„ç›®å½•æµè§ˆåŠŸèƒ½</li>
<li><code>--without-http_geo_module</code>ï¼šä¸å®‰è£…geoæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥æ ¹æ®ä¸åŒåœ°åŒºå“åº”ä¸åŒå†…å®¹</li>
<li><code>--without-http_map_module</code>ï¼šä¸å®‰è£…mapæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥åˆ›å»ºkey-valueæ˜ å°„è¡¨</li>
<li><code>--without-http_split_clients_module</code>ï¼šä¸å®‰è£…split clientæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥æ ¹æ®å®¢æˆ·ç«¯ä¿¡æ¯ï¼ˆipã€headerä¿¡æ¯ã€cookieç­‰ï¼‰åŒºåˆ†å¤„ç†</li>
<li><code>--without-http_referer_module</code>ï¼šä¸å®‰è£…refereræ¨¡å—ï¼Œæ¨¡å—å¯æ ¹æ®è¯·æ±‚çš„refererå­—æ®µæ‹’ç»è¯·æ±‚</li>
<li><code>--without-http_rewrite_module</code>ï¼šä¸å®‰è£…rewriteæ¨¡å—ï¼Œæ¨¡å—æä¾›é‡å®šå‘åŠŸèƒ½</li>
<li><code>--without-http_proxy_module</code>ï¼šä¸å®‰è£…proxyæ¨¡å—ï¼Œæ¨¡å—æä¾›åä»£ç†åŠŸèƒ½</li>
<li><code>--without-http_fastcgi_module</code>ï¼šä¸å®‰è£…fastcgiæ¨¡å—ï¼Œ</li>
<li><code>--without-http_uwsgi_module</code>ï¼šä¸å®‰è£…uwsgiæ¨¡å—ï¼Œ</li>
<li><code>--without-http_scgi_module</code>ï¼šä¸å®‰è£…scgiæ¨¡å—ï¼Œ</li>
<li><code>--without-http_memecached_module</code>ï¼šä¸å®‰è£…memecachedæ¨¡å—ï¼Œç¼“å­˜</li>
<li><code>--without-http_limit_zone_module</code>ï¼šä¸å®‰è£…limit zoneæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥é™åˆ¶ipå¹¶å‘è¿æ¥æ•°é‡ï¼Œæ¯”å¦‚è®¾ç½®ä¸€ä¸ªipåªèƒ½ä¸€ä¸ªè¿æ¥</li>
<li><code>--without-http_limit_req_module</code>ï¼šä¸å®‰è£…limit reqæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥é™åˆ¶ipå¹¶å‘è¯·æ±‚æ•°é‡</li>
<li><code>--without-http_empty_gif_module</code>ï¼šä¸å®‰è£…empty gifæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥åœ¨æ¥æ”¶åˆ°æ— æ•ˆè¯·æ±‚æ—¶è¿”å›ä¸€ä¸ª1*1åƒç´ çš„å›¾ç‰‡</li>
<li><code>--without-http_browser_module</code>ï¼šä¸å®‰è£…browseræ¨¡å—ï¼Œæ¨¡å—å¯æ ¹æ®è¯·æ±‚ä¸­çš„user-agentå­—æ®µè¯†åˆ«æµè§ˆå™¨</li>
<li><code>--without-http_upstream_ip_hash_module</code>ï¼šä¸å®‰è£…upstream ip hashæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥å¯¹ipè¿›è¡Œå“ˆå¸Œï¼Œè®©è¯·æ±‚è½¬å‘ç»™å¯¹åº”ipå“åº”ï¼Œè´Ÿè½½å‡è¡¡ç”¨ã€‚</li>
<li>ã€‚ã€‚ã€‚</li>
</ul>
</li>
<li>ä¸é»˜è®¤å®‰è£…è¿›httpæ¨¡å—ï¼ˆnginxå®‰è£…æ—¶é»˜è®¤ä¸ä¼šå®‰è£…çš„httpåŠŸèƒ½ï¼Œå¦‚æœéœ€è¦å°±ç”¨<code>--with-http-xxx</code>æ·»åŠ ï¼‰<ul>
<li><code>--with-http_ssl_module</code>ï¼šå®‰è£…sslæ¨¡å—ï¼Œæ¨¡å—æä¾›httpsæœåŠ¡ï¼ˆéœ€è¦åœ¨configè®¾ç½®æ—¶é…ç½®opensslåº“ï¼‰</li>
<li><code>--with-http_realip_module</code>ï¼šå®‰è£…realipæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥ä»è¯·æ±‚headerä¸­è·å–å®¢æˆ·ç«¯çœŸæ­£ip</li>
<li><code>--with-http_addition_module</code>ï¼šå®‰è£…additionæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥åœ¨å“åº”å¤´éƒ¨ã€å°¾éƒ¨æ·»åŠ å†…å®¹</li>
<li><code>--with-http_xslt_module</code>ï¼šå®‰è£…xsltæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥å“åº”xmlæ—¶åŠ å…¥xslæ¸²æŸ“ï¼ˆéœ€è¦åœ¨configè®¾ç½®æ—¶é…ç½®libxml2åº“ã€libxsltåº“ï¼‰</li>
<li><code>--with-http_image_filter_module</code>ï¼šå®‰è£…image filteræ¨¡å—ï¼Œæ¨¡å—å¯ä»¥å°†å›¾ç‰‡ï¼ˆjpegã€pngã€gifï¼‰å®æ—¶å‹ç¼©ä¸ºæŒ‡å®šå¤§å°è¿›è¡Œå“åº”ï¼ˆlibgdåº“ï¼‰</li>
<li><code>--with-http_geoip_module</code>ï¼šå®‰è£…geoipæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥æ ¹æ®ipè·å–å¯¹åº”å®é™…åœ°ç†ä½ç½®</li>
<li><code>--with-http_sub_module</code>ï¼šå®‰è£…subæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥æ›¿æ¢å“åº”çš„æŒ‡å®šå­—ç¬¦ä¸²</li>
<li><code>--with-http_dav_module</code>ï¼šå®‰è£…sslæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥è®©nginxæ”¯æŒwebdavæ ‡å‡†ï¼Œä½¿ç”¨putã€deleteã€copyã€moveç­‰è¯·æ±‚</li>
<li><code>--with-http_mp4_module</code>ï¼šå®‰è£…mp4æ¨¡å—</li>
<li><code>--with-http_gzip_static_module</code>ï¼šå®‰è£…gzip staticæ¨¡å—ï¼Œä¸åŒgzipæ¨¡å—ï¼Œstaticçš„å¯ä»¥åœ¨è¿›è¡Œgzipå‹ç¼©å‰æ£€æŸ¥æ˜¯å¦å­˜åœ¨è¯¥å“åº”çš„ç¼“å­˜ï¼Œå‡å°‘cpuå‹ç¼©å‹åŠ›</li>
<li><code>--with-http_random_index_module</code>ï¼šå®‰è£…random indexæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥åœ¨å®¢æˆ·ç«¯è®¿é—®æŸç›®å½•æ—¶ï¼Œéšæœºè¿”å›è¯¥ç›®å½•ä¸­æŸä¸ªæ–‡ä»¶</li>
<li><code>--with-http_secure_link_module</code>ï¼šå®‰è£…secure linkæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥éªŒè¯è¯·æ±‚æ˜¯å¦æœ‰æ•ˆ</li>
<li><code>--with-http_degradation_module</code>ï¼šå®‰è£…degradationæ¨¡å—ï¼Œæ¨¡å—é’ˆå¯¹ç‰¹æ®Šç³»ç»Ÿåšè°ƒç”¨ä¼˜åŒ–ï¼ˆélinuxï¼‰</li>
<li><code>--with-http_sub_status_module</code>ï¼šå®‰è£…sub statusæ¨¡å—ï¼Œæ¨¡å—å¯ä»¥æä¾›nginxè¿è¡Œæ—¶æ€§èƒ½ç»Ÿè®¡ä¿¡æ¯</li>
<li><code>--with-google_perftools_module</code>ï¼šå®‰è£…google perftoolæ¨¡å—ï¼Œæ¨¡å—æä¾›è°·æ­Œæ€§èƒ½æµ‹è¯•å·¥å…·</li>
<li>ã€‚ã€‚ã€‚</li>
</ul>
</li>
<li>mailæ¨¡å—<ul>
<li><code>--with-mail</code>ï¼šå®‰è£…é‚®ä»¶æœåŠ¡å™¨çš„åä»£æ¨¡å—ï¼Œä½¿ç”¨imapã€pop3ã€smtpç­‰åè®®</li>
<li><code>--with-mail_ssl_module</code>ï¼šæ¨¡å—å¯ä»¥è®©åè®®åŸºäºhttpsä½¿ç”¨ï¼ˆopensslåº“ï¼‰</li>
<li><code>--without-mail_imap_module</code>ï¼šä¸ä½¿ç”¨imapåè®®</li>
<li><code>--without-mail_pop3_module</code>ï¼šä¸ä½¿ç”¨pop3åè®®</li>
<li><code>--without-mail_smtp_module</code>ï¼šä¸ä½¿ç”¨smtpåè®®</li>
</ul>
</li>
<li>å…¶ä»–<ul>
<li><code>--with-debug</code>ï¼šnginxç ”ç©¶ã€è°ƒè¯•ç”¨</li>
<li><code>--add-module=PATH</code>ï¼šåœ¨nginxä¸­åŠ å…¥ç¬¬ä¸‰æ–¹æ¨¡å—</li>
<li><code>--without-http</code>ï¼šç¦ç”¨httpæœåŠ¡</li>
<li><code>--without-http-cache</code>ï¼šç¦ç”¨httpçš„ç¼“å­˜æœåŠ¡</li>
<li><code>--without-file-aio</code>ï¼šæ–‡ä»¶å¼‚æ­¥ioå¤„ç†</li>
<li><code>--with-ipv6</code>ï¼šæ”¯æŒipv6</li>
<li><code>--user=USER</code>ï¼šæŒ‡å®šworkerè¿›ç¨‹è¿è¡Œæ—¶æ‰€å±çš„ç”¨æˆ·ï¼ˆérootï¼‰</li>
<li><code>--group=GROUP</code>ï¼šæŒ‡å®šworkerè¿›ç¨‹è¿è¡Œæ—¶æ‰€å±çš„ç”¨æˆ·ç»„</li>
</ul>
</li>
</ul>
<h2 id="ä¸‰ç¼–è¯‘å®‰è£…">ä¸‰ã€ç¼–è¯‘å®‰è£…<a class="headerlink" href="#ä¸‰ç¼–è¯‘å®‰è£…" title="Permanent link">ğŸŸ</a></h2>
<ul>
<li>è¿›å…¥nginxç›®å½•</li>
<li>é…ç½®ï¼š<code>./configure [options]</code></li>
<li>ç¼–è¯‘ï¼š<code>make</code></li>
<li>å°†ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶è¿è¡Œæ–‡ä»¶å¤åˆ¶åˆ°é…ç½®å¥½çš„ç›®å½•ï¼š<code>make install</code></li>
</ul>
<blockquote>
<p>è¿™é‡Œé‡ç‚¹ä»‹ç»ä¸‹configureé…ç½®ï¼š
æ ¹æ®å‰é¢çš„<code>configureé…ç½®</code>é€‰æ‹©è‡ªå·±éœ€è¦çš„åº“ã€åŠŸèƒ½ï¼Œå…ˆä½¿ç”¨ç³»ç»ŸåŒ…ç®¡ç†å™¨å®‰è£…ä¾èµ–åº“ï¼Œå†é…ç½®configureã€‚
ä¸‹é¢å±•ç¤ºå‡ ä¸ªç¤ºä¾‹ï¼š</p>
</blockquote>
<h3 id="ç¤ºä¾‹a">ç¤ºä¾‹a<a class="headerlink" href="#ç¤ºä¾‹a" title="Permanent link">ğŸŸ</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="nb">cd</span> /home/shafish/software
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>wget https://nginx.org/download/nginx-1.20.2.tar.gz
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>tar -zxvf nginx-1.20.2.tar.gz
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="nb">cd</span> nginx-1.20.2
<a id="__codelineno-1-5" name="__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="c1"># pcre é‡å®šå‘æ—¶ä½¿ç”¨æ­£åˆ™åŒ¹é…</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="c1"># openssl ä½¿ç”¨https</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a>sudo pacman -S pcre* openssl*
<a id="__codelineno-1-9" name="__codelineno-1-9"></a>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a>./configure --prefix<span class="o">=</span>/usr/local/nginx-1.20.2 <span class="se">\ </span><span class="c1"># æŒ‡å®šå®‰è£…çš„æ ¹ç›®å½•</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a>--with-http_ssl_module  <span class="se">\ </span><span class="c1"># å®‰è£…ssl</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a>--with-http_spdy_module <span class="se">\ </span><span class="c1"># SPDYå¯ä»¥ç¼©çŸ­ç½‘é¡µçš„åŠ è½½æ—¶é—´</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a>--with-http_stub_status_module <span class="se">\ </span><span class="c1"># nginxç›‘æ§æ¨¡å—</span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a>--with-pcre <span class="se">\ </span><span class="c1"># å¯ç”¨pcre</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a>sudo make
<a id="__codelineno-1-17" name="__codelineno-1-17"></a>sudo make install
</code></pre></div>
<h3 id="ç¤ºä¾‹b">ç¤ºä¾‹b<a class="headerlink" href="#ç¤ºä¾‹b" title="Permanent link">ğŸŸ</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="nb">cd</span> /home/shafish/software
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>wget https://nginx.org/download/nginx-1.20.2.tar.gz
<a id="__codelineno-2-3" name="__codelineno-2-3"></a>tar -zxvf nginx-1.20.2.tar.gz
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="nb">cd</span> nginx-1.20.2
<a id="__codelineno-2-5" name="__codelineno-2-5"></a>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="c1"># å®‰è£…opensslåº“</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a>sudo pacman -S openssl*
<a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="c1"># ä¸‹è½½ç¬¬ä¸‰æ–¹åº“çš„æºç ï¼Œå¯¹åº“è¿›è¡Œç¼–è¯‘ä½¿ç”¨</span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a>wget http://labs.frickle.com/files/ngx_cache_purge-1.3.tar.gz
<a id="__codelineno-2-10" name="__codelineno-2-10"></a>tar -xzvf ngx_cache_purge-1.3.tar.gz
<a id="__codelineno-2-11" name="__codelineno-2-11"></a>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a>./configure --prefix<span class="o">=</span>/usr/local/nginx-1.20.2 <span class="se">\ </span><span class="c1"># æŒ‡å®šå®‰è£…çš„æ ¹ç›®å½•</span>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a>â€“with-http_stub_status_module <span class="se">\ </span><span class="c1"># å¯ç”¨ nginx çŠ¶æ€æ¨¡å—</span>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a>â€“with-http_ssl_module <span class="se">\ </span><span class="c1"># å¯ç”¨ SSL æ¨¡å—</span>
<a id="__codelineno-2-15" name="__codelineno-2-15"></a>â€“with-http_realip_module <span class="se">\ </span><span class="c1"># å¯ç”¨ realip æ¨¡å—ï¼ˆå°†ç”¨æˆ· IP è½¬å‘ç»™åç«¯æœåŠ¡å™¨ï¼‰</span>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a>â€“add-module<span class="o">=</span>./ngx_cache_purge-1.3 <span class="c1"># æ·»åŠ ç¼“å­˜æ¸…é™¤æ‰©å±•æ¨¡å—</span>
<a id="__codelineno-2-17" name="__codelineno-2-17"></a>
<a id="__codelineno-2-18" name="__codelineno-2-18"></a>sudo make
<a id="__codelineno-2-19" name="__codelineno-2-19"></a>sudo make install
</code></pre></div>
<h3 id="ç¤ºä¾‹c">ç¤ºä¾‹c<a class="headerlink" href="#ç¤ºä¾‹c" title="Permanent link">ğŸŸ</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>--prefix<span class="o">=</span>/usr/local/nginx --user<span class="o">=</span>www --group<span class="o">=</span>www --with-http_stub_status_module --with-http_v2_module --with-http_ssl_module --with-http_gzip_static_module --with-http_realip_module --with-http_flv_module --with-http_mp4_module --with-openssl<span class="o">=</span>../openssl-1.0.2p --with-pcre<span class="o">=</span>../pcre-8.42 --with-pcre-jit --with-ld-opt<span class="o">=</span>-ljemalloc
</code></pre></div>
<h2 id="å››ä¸ºå·²å®‰è£…çš„nginxåŠ¨æ€æ·»åŠ æ¨¡å—">å››ã€ä¸ºå·²å®‰è£…çš„NginxåŠ¨æ€æ·»åŠ æ¨¡å—<a class="headerlink" href="#å››ä¸ºå·²å®‰è£…çš„nginxåŠ¨æ€æ·»åŠ æ¨¡å—" title="Permanent link">ğŸŸ</a></h2>
<p>å®‰å¥½nginxåï¼Œè¿‡ä¸ªå‡ ä¸ªæœˆï¼Œå†åŠ å¤šå‡ ä¸ªéœ€æ±‚ï¼Œå¯¹å§ï¼Œä½ æ‡‚çš„ã€‚</p>
<p>nginxæ·»åŠ æ¨¡å—è¿˜æ˜¯è¦é‡æ–°ç¼–è¯‘æ‰è¡Œã€‚</p>
<h3 id="åŠ ngx_http_google_filter_module">åŠ ngx_http_google_filter_module<a class="headerlink" href="#åŠ ngx_http_google_filter_module" title="Permanent link">ğŸŸ</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="c1"># è¿›å…¥nginxå®‰è£…ç›®å½•ï¼Œçœ‹ä¸Šé¢ç¤ºä¾‹a b</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="nb">cd</span> <span class="nb">cd</span> /home/shafish/software/nginx-1.20.2
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="c1"># ä¸‹è½½éœ€è¦çš„æ¨¡å—æºç </span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a>git clone https://github.com/cuber/ngx_http_google_filter_module
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="c1"># æŸ¥çœ‹å®‰è£…æ—¶çš„é…ç½®</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a>./nginx -V
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="c1"># ./configure --prefix=/usr/local/nginx-1.20.2 â€“with-http_stub_status_module â€“with-http_ssl_module â€“with-http_realip_module â€“add-module=./ngx_cache_purge-1.3</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="c1"># åŠ å…¥æ–°æ¨¡å—é…ç½®</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a>./configure --prefix<span class="o">=</span>/usr/local/nginx-1.20.2 â€“with-http_stub_status_module â€“with-http_ssl_module â€“with-http_realip_module â€“add-module<span class="o">=</span>./ngx_cache_purge-1.3 <span class="se">\ </span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a>--add-module<span class="o">=</span>/usr/local/nginx/ngx_http_google_filter_module
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="c1"># æ‰§è¡Œç¼–è¯‘</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a>sudo make
<a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="c1"># æ›¿æ¢nginxäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæœ¨æœ‰make installå“Ÿ</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a>mv ./sbin/nginx ./sbin/nginx.bak
<a id="__codelineno-4-15" name="__codelineno-4-15"></a>cp ./objs/nginx ./sbin/
<a id="__codelineno-4-16" name="__codelineno-4-16"></a>./nginx -V
</code></pre></div>
<h2 id="äº”nginxå‘½ä»¤">äº”ã€nginxå‘½ä»¤<a class="headerlink" href="#äº”nginxå‘½ä»¤" title="Permanent link">ğŸŸ</a></h2>
<blockquote>
<p>é»˜è®¤å®‰è£…è·¯å¾„ï¼š<code>--prefix=/usr/local/nginx</code></p>
</blockquote>
<ul>
<li>å¯åŠ¨nginxï¼š<code>/usr/local/nginx/sbin/nginx</code> ï¼ˆé»˜è®¤åŠ è½½çš„æ˜¯/usr/local/nginx/conf/nginx.confé…ç½®ï¼‰</li>
<li>å¯åŠ¨æ—¶æŒ‡å®šé…ç½®ï¼š<code>/usr/local/nginx/sbin/nginx -c /tmp/nginx.conf</code> ï¼ˆ-cæŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„ï¼‰</li>
<li>æµ‹è¯•é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®ï¼š<code>/usr/local/nginx/sbin/nginx -t</code></li>
<li>æ˜¾ç¤ºç¼–è¯‘é˜¶æ®µç”¨çš„å‚æ•°ï¼š<code>/usr/local/nginx/sbin/nginx -V</code></li>
<li>â€œä¼˜é›…â€åœ°åœæ­¢æœåŠ¡ï¼š<code>/usr/local/nginx/sbin/nginx -s quit</code></li>
<li>è¿è¡Œæ—¶é‡è½½é…ç½®æ–‡ä»¶ï¼š<code>/usr/local/nginx/sbin/nginx -s reload</code></li>
<li>ä¸é‡å¯å‡çº§nginxç‰ˆæœ¬ï¼š</li>
</ul>
<h2 id="å…­nginxåŸºæœ¬çš„é…ç½®">å…­ã€nginxåŸºæœ¬çš„é…ç½®<a class="headerlink" href="#å…­nginxåŸºæœ¬çš„é…ç½®" title="Permanent link">ğŸŸ</a></h2>
<h3 id="1ç”¨äºè°ƒè¯•é—®é¢˜å®šä½çš„é…ç½®">1.ç”¨äºè°ƒè¯•ã€é—®é¢˜å®šä½çš„é…ç½®<a class="headerlink" href="#1ç”¨äºè°ƒè¯•é—®é¢˜å®šä½çš„é…ç½®" title="Permanent link">ğŸŸ</a></h3>
<table>
<thead>
<tr>
<th align="left">é…ç½®é¡¹ç›®</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>daemon on|off;</code></td>
<td align="left">æ˜¯å¦ä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡ŒNginxï¼ˆé»˜è®¤onï¼‰</td>
</tr>
<tr>
<td align="left"><code>master_process on|off;</code></td>
<td align="left">æ˜¯å¦ä»¥master/workeræ–¹å¼å·¥ä½œï¼ˆé»˜è®¤onï¼‰</td>
</tr>
<tr>
<td align="left"><code>error_log /path/file level;</code></td>
<td align="left">å¤§äºæˆ–ç­‰äºè¯¥çº§åˆ«çš„æ—¥å¿—éƒ½ä¼šè¢«è¾“å‡ºåˆ°/path/fileæ–‡ä»¶ä¸­ã€‚levelå–å€¼ï¼šdebugã€infoã€noticeã€warnã€errorã€critã€alertã€emerg</td>
</tr>
<tr>
<td align="left"><code>debug_connection[IP|CIDR]</code></td>
<td align="left">å¿…é¡»æ”¾åœ¨events{...}ä¸­æ‰æœ‰æ•ˆï¼Œä»…ä»…æ¥è‡ªè§„å®šçš„ipè¯·æ±‚æ‰ä¼šè¾“å‡ºdebugæ—¥å¿—</td>
</tr>
<tr>
<td align="left"><code>worker_rlimit_core size;</code></td>
<td align="left">é™åˆ¶coredumpæ ¸å¿ƒè½¬å‚¨æ–‡ä»¶çš„å¤§å°</td>
</tr>
<tr>
<td align="left"><code>working_directory path;</code></td>
<td align="left">æŒ‡å®šcoredumpæ–‡ä»¶ç”Ÿæˆç›®å½•</td>
</tr>
</tbody>
</table>
<h3 id="2è¿è¡Œå¿…å¤‡é…ç½®">2.è¿è¡Œå¿…å¤‡é…ç½®<a class="headerlink" href="#2è¿è¡Œå¿…å¤‡é…ç½®" title="Permanent link">ğŸŸ</a></h3>
<table>
<thead>
<tr>
<th align="left">é…ç½®é¡¹ç›®</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>env VAR|VAR=VALUE</code></td>
<td align="left">å®šä¹‰ç¯å¢ƒå˜é‡(env TESTPATH=/tmp/;)</td>
</tr>
<tr>
<td align="left"><code>include/path/file;</code></td>
<td align="left">åµŒå…¥å…¶ä»–é…ç½®æ–‡ä»¶(ç›¸å¯¹ç›®å½•ï¼šå³nginx.confæ‰€åœ¨çš„ç›®å½•)</td>
</tr>
<tr>
<td align="left"><code>pid path/file;</code></td>
<td align="left">ä¿å­˜masterè¿›ç¨‹idçš„pidæ–‡ä»¶è·¯å¾„</td>
</tr>
<tr>
<td align="left"><code>user username[groupname];</code></td>
<td align="left">Nginx workerè¿›ç¨‹è¿è¡Œçš„ç”¨æˆ·åŠç”¨æˆ·ç»„</td>
</tr>
<tr>
<td align="left"><code>worker_rlimit_nofile limit;</code></td>
<td align="left">æŒ‡å®šNginx workerè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§å¥æŸ„æè¿°ç¬¦ä¸ªæ•°</td>
</tr>
<tr>
<td align="left"><code>worker_rlimit_sigpending limit;</code></td>
<td align="left">è®¾ç½®æ¯ä¸ªç”¨æˆ·å‘å¾€Nginxçš„ä¿¡å·é˜Ÿåˆ—çš„å¤§å°</td>
</tr>
</tbody>
</table>
<h3 id="3æ€§èƒ½ä¼˜åŒ–é…ç½®">3.æ€§èƒ½ä¼˜åŒ–é…ç½®<a class="headerlink" href="#3æ€§èƒ½ä¼˜åŒ–é…ç½®" title="Permanent link">ğŸŸ</a></h3>
<table>
<thead>
<tr>
<th align="left">é…ç½®é¡¹ç›®</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>worker_processes number;</code></td>
<td align="left">Nginx workerè¿›ç¨‹ä¸ªæ•°(ä¸€èˆ¬è·Ÿæ ¸æ•°ç›¸åŒå³å¯)</td>
</tr>
<tr>
<td align="left"><code>worker_cpu_affinity cpumask[cpumask...]</code></td>
<td align="left">[Linux]ç»‘å®šNginx workerè¿›ç¨‹åˆ°æŒ‡å®šçš„CPUå†…æ ¸</td>
</tr>
<tr>
<td align="left"><code>ssl_engine device;</code></td>
<td align="left">SSLç¡¬ä»¶åŠ é€Ÿ(openssl engine -tæŸ¥çœ‹æ˜¯å¦æœ‰åŠ é€Ÿè®¾å¤‡)</td>
</tr>
<tr>
<td align="left"><code>timer_resolution t;</code></td>
<td align="left">ç³»ç»Ÿè°ƒç”¨gettimeofdayçš„æ‰§è¡Œé¢‘ç‡(æ—¶é—´èƒ½å‡†ä¸€ç‚¹)</td>
</tr>
<tr>
<td align="left"><code>worker_priority nice;</code></td>
<td align="left">Nginx workerè¿›ç¨‹ä¼˜å…ˆçº§è®¾ç½®ï¼Œâ€“20~+19ï¼Œâ€“20æ˜¯æœ€é«˜ä¼˜å…ˆçº§ï¼Œ+19æ˜¯æœ€ä½ä¼˜å…ˆçº§</td>
</tr>
<tr>
<td align="left"><code>worker_rlimit_sigpending limit;</code></td>
<td align="left">è®¾ç½®æ¯ä¸ªç”¨æˆ·å‘å¾€Nginxçš„ä¿¡å·é˜Ÿåˆ—çš„å¤§å°</td>
</tr>
</tbody>
</table>
<h3 id="4äº‹ä»¶ç±»å‹é…ç½®">4.äº‹ä»¶ç±»å‹é…ç½®<a class="headerlink" href="#4äº‹ä»¶ç±»å‹é…ç½®" title="Permanent link">ğŸŸ</a></h3>
<table>
<thead>
<tr>
<th align="left">é…ç½®é¡¹ç›®</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>accept_mutex[on|off];</code></td>
<td align="left">é»˜è®¤onï¼Œæ˜¯å¦æ‰“å¼€accepté”ï¼Œè´Ÿè½½å‡è¡¡é”</td>
</tr>
<tr>
<td align="left"><code>lock_file path/file;</code></td>
<td align="left">lockæ–‡ä»¶çš„è·¯å¾„ï¼Œæ–‡ä»¶é”</td>
</tr>
<tr>
<td align="left"><code>accept_mutex_delay Nms;</code></td>
<td align="left">ä½¿ç”¨accepté”ååˆ°çœŸæ­£å»ºç«‹è¿æ¥ä¹‹é—´çš„å»¶è¿Ÿæ—¶é—´ï¼Œå¦‚æœæœ‰ä¸€ä¸ªworkerè¿›ç¨‹è¯•å›¾å–accepté”è€Œæ²¡æœ‰å–åˆ°ï¼Œå®ƒè‡³å°‘è¦ç­‰accept_mutex_delayå®šä¹‰çš„æ—¶é—´é—´éš”åæ‰èƒ½å†æ¬¡è¯•å›¾å–é”</td>
</tr>
<tr>
<td align="left"><code>multi_accept[on|off];</code></td>
<td align="left">é»˜è®¤offï¼Œæ‰¹é‡å»ºç«‹æ–°è¿æ¥</td>
</tr>
<tr>
<td align="left"><code>use[kqueue|rtsig|epoll|/dev/poll|select|poll|eventport];</code></td>
<td align="left">é€‰æ‹©äº‹ä»¶æ¨¡å‹ï¼Œé»˜è®¤ä¼šè‡ªåŠ¨ä½¿ç”¨æœ€é€‚åˆçš„äº‹ä»¶æ¨¡å‹</td>
</tr>
<tr>
<td align="left"><code>worker_connections number;</code></td>
<td align="left">æ¯ä¸ªworkerçš„æœ€å¤§è¿æ¥æ•°</td>
</tr>
</tbody>
</table>
<h3 id="ä¸ƒnginx-httpæ¨¡å—é…ç½®">ä¸ƒã€nginx httpæ¨¡å—é…ç½®<a class="headerlink" href="#ä¸ƒnginx-httpæ¨¡å—é…ç½®" title="Permanent link">ğŸŸ</a></h3>
<p>nginxä¸»è¦é ngx_http_core_moduleæ¨¡å—å®ç°ã€‚</p>
<h3 id="1æ¨¡å—å˜é‡">1.æ¨¡å—å˜é‡<a class="headerlink" href="#1æ¨¡å—å˜é‡" title="Permanent link">ğŸŸ</a></h3>
<p><img alt="" src="https://picture.cdn.shafish.cn/blog/nginx-2021-12-nginx_http_variable1.png" /></p>
<p><img alt="" src="https://picture.cdn.shafish.cn/blog/nginx-2021-12-nginx_http_variable2.png" /></p>
<h3 id="2è™šæ‹Ÿä¸»æœºä¸è¯·æ±‚çš„åˆ†å‘">2.è™šæ‹Ÿä¸»æœºä¸è¯·æ±‚çš„åˆ†å‘<a class="headerlink" href="#2è™šæ‹Ÿä¸»æœºä¸è¯·æ±‚çš„åˆ†å‘" title="Permanent link">ğŸŸ</a></h3>
<p>æ¯ä¸ªserverå—éƒ½æ˜¯ä¸€ä¸ªè™šæ‹Ÿä¸»æœºã€‚</p>
<ul>
<li>ç›‘å¬ç«¯å£ï¼š<code>listen address:port[default(deprecated in 0.8.21)|default_server|[backlog=num|rcvbuf=size|sndbuf=size|accept_filter=filter|deferred|bind|ipv6only=[on|off]|ssl]];</code></li>
<li><code>default/default_server</code>ï¼šå°†æ‰€åœ¨çš„serverå—ä½œä¸ºnginxé»˜è®¤è™šæ‹Ÿä¸»æœºï¼Œå¦åˆ™é»˜è®¤æ˜¯é€‰é…ç½®ä¸­ç¬¬ä¸€ä¸ªserverå—derï¼ˆå½“ä¸€ä¸ªè¯·æ±‚æ— æ³•åŒ¹é…é…ç½®æ–‡ä»¶ä¸­çš„æ‰€æœ‰ä¸»æœºåŸŸåæ—¶ï¼Œå°±ä¼šé€‰ç”¨é»˜è®¤çš„è™šæ‹Ÿä¸»æœºï¼‰ã€‚</li>
<li><code>backlog=num</code>ï¼šè¡¨ç¤ºTCPä¸­backlogé˜Ÿåˆ—çš„å¤§å°ï¼Œå¦‚æœbacklogé˜Ÿåˆ—å·²æ»¡ï¼Œè¿˜æœ‰æ–°çš„å®¢æˆ·ç«¯è¯•å›¾é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹TCPè¿æ¥ï¼Œè¿™æ—¶å®¢æˆ·ç«¯å°†ä¼šå»ºç«‹è¿æ¥å¤±è´¥ã€‚</li>
<li><code>rcvbuf=size</code>ï¼šè®¾ç½®ç›‘å¬å¥æŸ„çš„SO_RCVBUFå‚æ•°ã€‚</li>
<li><code>sndbuf=size</code>ï¼šè®¾ç½®ç›‘å¬å¥æŸ„çš„SO_SNDBUFå‚æ•°ã€‚</li>
<li><code>deferred</code>ï¼šé€‚ç”¨äºå¤§å¹¶å‘ï¼Œå½“è¯·æ±‚æ•°æ®æ¥ä¸´æ—¶ï¼Œworkerè¿›ç¨‹æ‰ä¼šå¼€å§‹å¤„ç†è¿™ä¸ªè¿æ¥ã€‚</li>
<li><code>bind</code>ï¼šç»‘å®šå½“å‰ç«¯å£/åœ°å€å¯¹ï¼ŒåŒæ—¶å¯¹ä¸€ä¸ªç«¯å£ç›‘å¬å¤šä¸ªåœ°å€æ—¶æ‰ä¼šç”Ÿæ•ˆã€‚</li>
<li><code>ssl</code>ï¼šåœ¨å½“å‰ç›‘å¬çš„ç«¯å£ä¸Šå»ºç«‹çš„è¿æ¥å¿…é¡»åŸºäºSSLåè®®ã€‚</li>
</ul>
<blockquote>
<p>åœ¨å¼€å§‹å¤„ç†ä¸€ä¸ªHTTPè¯·æ±‚æ—¶ï¼ŒNginxä¼šå–å‡ºheaderå¤´ä¸­çš„Hostï¼Œä¸æ¯ä¸ªserverä¸­çš„server_nameè¿›è¡ŒåŒ¹é…ï¼Œä»¥æ­¤å†³å®šåˆ°åº•ç”±å“ªä¸€ä¸ªserverå—æ¥å¤„ç†è¿™ä¸ªè¯·æ±‚ã€‚</p>
</blockquote>
<ul>
<li>ä¸»æœºåç§°ï¼š<code>server_name name[...];</code></li>
<li>
<p>å¤šåŸŸåå¯¹åº”ä¸€ä¸ªæœåŠ¡å™¨ipï¼Œå¯ä»¥æ ¹æ®serverå—ä¸­å®šä¹‰çš„server_nameæ¥å¤„ç†å¯¹åº”åŸŸåçš„è¯·æ±‚ã€‚</p>
</li>
<li>
<p>è®¾ç½®æ•£åˆ—æ¡¶å ç”¨çš„å†…å­˜å¤§å°ï¼š<code>server_names_hash_bucket_size size;</code></p>
</li>
<li>
<p>Nginxä½¿ç”¨æ•£åˆ—è¡¨æ¥å­˜å‚¨server nameï¼Œæé«˜å¿«é€Ÿå¯»æ‰¾åˆ°ç›¸åº”server nameçš„èƒ½åŠ›ã€‚</p>
</li>
<li>
<p><code>server_names_hash_max_size</code></p>
</li>
<li>
<p>é»˜è®¤ï¼š512ï¼Œè¶Šå¤§ï¼Œæ¶ˆè€—çš„å†…å­˜å°±è¶Šå¤šï¼Œä½†æ•£åˆ—keyçš„å†²çªç‡åˆ™ä¼šé™ä½ï¼Œserver nameæ£€ç´¢é€Ÿåº¦ä¹Ÿæ›´å¿«ã€‚</p>
</li>
<li>
<p>é‡å®šå‘ä¸»æœºåç§°çš„å¤„ç†ï¼š<code>server_name_in_redirect on|off;</code></p>
</li>
<li>
<p>é»˜è®¤ï¼šonï¼Œè¡¨ç¤ºåœ¨é‡å®šå‘è¯·æ±‚æ—¶ä¼šä½¿ç”¨server_nameé‡Œé…ç½®çš„ç¬¬ä¸€ä¸ªä¸»æœºåä»£æ›¿åŸå…ˆè¯·æ±‚ä¸­çš„Hostå¤´éƒ¨ã€‚</p>
</li>
<li>
<p>uriè¯·æ±‚åŒ¹é…ï¼š<code>location[=|~|~*|^~|@]/uri/{...}</code></p>
</li>
<li><code>=</code>ï¼šæŠŠURIä½œä¸ºå­—ç¬¦ä¸²è¿›è¡ŒåŒ¹é…ã€‚
  <div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="nv">location</span> <span class="o">=</span> / <span class="o">{</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a>  <span class="c1"># åªæœ‰å½“ç”¨æˆ·è¯·æ±‚æ˜¯/æ—¶ï¼Œæ‰ä¼šä½¿ç”¨è¯¥locationä¸‹çš„é…ç½®</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a>  â€¦
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="o">}</span>
</code></pre></div></li>
<li><code>~</code>ï¼šè¡¨ç¤ºåŒ¹é…URIæ—¶æ˜¯å­—æ¯å¤§å°å†™æ•æ„Ÿçš„ã€‚</li>
<li><code>~*</code>ï¼šè¡¨ç¤ºåŒ¹é…URIæ—¶å¿½ç•¥å­—æ¯å¤§å°å†™é—®é¢˜ã€‚</li>
<li><code>^~</code>ï¼šè¡¨ç¤ºåŒ¹é…URIæ—¶åªéœ€è¦å…¶å‰åŠéƒ¨åˆ†ä¸uriå‚æ•°åŒ¹é…å³å¯ã€‚
  <div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a>location ^~ /images/ <span class="o">{</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a>  <span class="c1"># ä»¥/images/å¼€å§‹çš„è¯·æ±‚éƒ½ä¼šåŒ¹é…ä¸Š</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a>  â€¦
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="o">}</span>
</code></pre></div></li>
<li><code>@</code>ï¼šè¡¨ç¤ºä»…ç”¨äºNginxæœåŠ¡å†…éƒ¨è¯·æ±‚ä¹‹é—´çš„é‡å®šå‘ï¼Œä¸ç›´æ¥å¤„ç†ç”¨æˆ·è¯·æ±‚ã€‚</li>
<li><code>æ­£åˆ™è¡¨è¾¾å¼</code>ï¼šç”¨æ­£åˆ™åŒ¹é…å‘—ã€‚
  <div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a>location ~* <span class="se">\.</span><span class="o">(</span>gif<span class="p">|</span>jpg<span class="p">|</span>jpeg<span class="o">)</span>$ <span class="o">{</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a>  <span class="c1"># åŒ¹é…ä»¥ .gifã€.jpgã€.jpegç»“å°¾çš„è¯·æ±‚</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a>  â€¦
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="o">}</span>
</code></pre></div></li>
</ul>
<h3 id="3æ–‡ä»¶è·¯å¾„çš„å®šä¹‰">3.æ–‡ä»¶è·¯å¾„çš„å®šä¹‰<a class="headerlink" href="#3æ–‡ä»¶è·¯å¾„çš„å®šä¹‰" title="Permanent link">ğŸŸ</a></h3>
<ul>
<li>æŒ‡å®šæ ¹ç›®å½•ï¼š<code>root path;</code></li>
<li>
<p>é»˜è®¤ï¼šroot html
  <div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>location /download/ <span class="o">{</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>  <span class="c1"># è¯·æ±‚çš„URIæ˜¯/download/index/test.htmlï¼ŒæœåŠ¡å™¨è¿”å›/opt/web/html/download/index/test.htmlæ–‡ä»¶çš„å†…å®¹</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a>  root /opt/web/html/<span class="p">;</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="o">}</span>
</code></pre></div></p>
</li>
<li>
<p>å°†uriè¯·æ±‚ç›®å½•æ˜ å°„ä¸ºæ ¹ç›®å½•ï¼š<code>alias path;</code>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a>location /conf <span class="o">{</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a>  <span class="c1"># è¯·æ±‚çš„URIæ˜¯/conf/nginx.confï¼ŒæœåŠ¡å™¨è¿”å›/usr/local/nginx/conf/nginx.confï¼Œå°†/confæ˜ å°„ä¸ºäº†/usr/local/nginx/conf/</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a>  <span class="nb">alias</span> /usr/local/nginx/conf/<span class="p">;</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="o">}</span>
</code></pre></div></p>
</li>
<li>
<p>è®¿é—®é¦–é¡µï¼š<code>index file...;</code></p>
</li>
<li>
<p>é»˜è®¤ï¼šindex index.html;</p>
</li>
<li>
<p>æ ¹æ®HTTPè¿”å›ç é‡å®šå‘é¡µé¢ï¼š<code>error_page code[code...][=|=answer-code]uri|@named_location</code>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a>error_page <span class="m">404</span> /404.html<span class="p">;</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a>error_page <span class="m">502</span> <span class="m">503</span> <span class="m">504</span> /50x.html<span class="p">;</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a>error_page <span class="m">403</span> http://example.com/forbidden.html<span class="p">;</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="c1"># é‡å®šå‘åˆ°å¦ä¸€ä¸ªlocationä¸­è¿›è¡Œå¤„ç†</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a>error_page <span class="nv">404</span> <span class="o">=</span> @fallback<span class="p">;</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a>location @fallback <span class="o">(</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a>  proxy_pass http://backend<span class="p">;</span>
<a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="o">)</span>
</code></pre></div></p>
</li>
<li>
<p>æ˜¯å¦å…è®¸é€’å½’ä½¿ç”¨error_pageï¼š<code>recursive_error_pages[on|off];</code></p>
</li>
<li>
<p>é»˜è®¤ï¼šrecursive_error_pages off;</p>
</li>
<li>
<p>å¯»æ‰¾æ–‡ä»¶ï¼š<code>try_files path1[path2] uri;</code>
  <div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="c1"># æŒ‰ç…§é¡ºåºæ‰¾è¿™äº›æ–‡ä»¶ï¼Œæ–‡ä»¶å­˜åœ¨å°±è¿”å›ï¼Œç»“æŸè¯·æ±‚ï¼Œå¦‚æœéƒ½æ‰¾ä¸åˆ°å°±è¿›å…¥è®¾ç½®å¥½çš„é‡å®šå‘å¤„ç†ã€‚</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a>try_files /system/maintenance.html <span class="nv">$uri</span> <span class="nv">$uri</span>/index.html <span class="nv">$uri</span>.html @other<span class="p">;</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a>location @other <span class="o">{</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a>  proxy_pass http://backend<span class="p">;</span>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="o">}</span>
</code></pre></div></p>
</li>
</ul>
<h3 id="4å†…å­˜åŠç£ç›˜èµ„æºçš„åˆ†é…">4.å†…å­˜åŠç£ç›˜èµ„æºçš„åˆ†é…<a class="headerlink" href="#4å†…å­˜åŠç£ç›˜èµ„æºçš„åˆ†é…" title="Permanent link">ğŸŸ</a></h3>
<blockquote>
<p>å¤„ç†è¯·æ±‚æ—¶å†…å­˜ã€ç£ç›˜èµ„æºåˆ†é…çš„é…ç½®é¡¹</p>
</blockquote>
<ul>
<li>HTTPåŒ…ä½“åªå­˜å‚¨åˆ°ç£ç›˜æ–‡ä»¶ä¸­ï¼š<code>client_body_in_file_only on|clean|off;</code></li>
<li>é»˜è®¤ï¼šclient_body_in_file_only off;</li>
<li>
<p>å½“è®¾ç½®ä¸ºon|cleanæ—¶ï¼Œè¯·æ±‚åŒ…ä½“ä¼šå­˜å‚¨åœ¨ç£ç›˜æ–‡ä»¶ä¸­ã€‚</p>
</li>
<li>
<p>HTTPåŒ…ä½“å°½é‡å†™å…¥åˆ°ä¸€ä¸ªå†…å­˜bufferä¸­ï¼š<code>client_body_in_single_buffer on|off;</code></p>
</li>
<li>é»˜è®¤ï¼šclient_body_in_single_buffer off;</li>
<li>
<p>å¦‚æœåŒ…ä½“å†…å®¹å¤§è¿‡client_body_buffer_sizeï¼ŒåŒ…ä½“å†…å®¹å°±å­˜å‚¨åœ¨ç£ç›˜æ–‡ä»¶ä¸­</p>
</li>
<li>
<p>å­˜å‚¨HTTPå¤´éƒ¨çš„å†…å­˜bufferå¤§å°ï¼š<code>client_header_buffer_size size;</code></p>
</li>
<li>é»˜è®¤ï¼šclient_header_buffer_size 1k;</li>
<li>
<p>æ­£å¸¸æƒ…å†µä¸‹Nginxæ¥æ”¶ç”¨æˆ·è¯·æ±‚ä¸­HTTP headeréƒ¨åˆ†ï¼ˆåŒ…æ‹¬HTTPè¡Œå’ŒHTTPå¤´éƒ¨ï¼‰æ—¶åˆ†é…çš„å†…å­˜bufferå¤§å°</p>
</li>
<li>
<p>å­˜å‚¨è¶…å¤§HTTPå¤´éƒ¨çš„å†…å­˜bufferå¤§å°ï¼š<code>large_client_header_buffers number size;</code></p>
</li>
<li>é»˜è®¤ï¼šlarge_client_header_buffers 48k;</li>
<li>
<p>å®šä¹‰äº†Nginxæ¥æ”¶ä¸€ä¸ªè¶…å¤§HTTPå¤´éƒ¨è¯·æ±‚çš„bufferä¸ªæ•°å’Œæ¯ä¸ªbufferçš„å¤§å°</p>
</li>
<li>
<p>å­˜å‚¨HTTPåŒ…ä½“çš„å†…å­˜bufferå¤§å°ï¼š<code>client_body_buffer_size size;</code></p>
</li>
<li>é»˜è®¤ï¼šclient_body_buffer_size 8k/16k;</li>
<li>
<p>å®šä¹‰äº†Nginxæ¥æ”¶HTTPåŒ…ä½“çš„å†…å­˜ç¼“å†²åŒºå¤§å°</p>
</li>
<li>
<p>HTTPåŒ…ä½“çš„ä¸´æ—¶å­˜æ”¾ç›®å½•ï¼š<code>client_body_temp_path dir-path[level1[level2[level3]]]</code></p>
</li>
<li>
<p>client_body_temp_path /opt/nginx/client_temp 1 2;</p>
</li>
<li>
<p>æŒ‡å®šä¸ºè¿æ¥æˆåŠŸçš„è¯·æ±‚åˆ†é…å†…å­˜æ± åˆå§‹å¤§å°ï¼š<code>connection_pool_size size;</code></p>
</li>
<li>
<p>é»˜è®¤ï¼šconnection_pool_size 256;</p>
</li>
<li>
<p>å¼€å§‹å¤„ç†è¯·æ±‚ï¼Œä¸ºæ¯ä¸ªè¯·æ±‚åˆ†é…çš„å†…å­˜æ± å¤§å°ï¼š<code>request_pool_size size;</code></p>
</li>
<li>é»˜è®¤ï¼šrequest_pool_size 4k;</li>
</ul>
<h3 id="5ç½‘ç»œè¿æ¥çš„è®¾ç½®">5.ç½‘ç»œè¿æ¥çš„è®¾ç½®<a class="headerlink" href="#5ç½‘ç»œè¿æ¥çš„è®¾ç½®" title="Permanent link">ğŸŸ</a></h3>
<ul>
<li>è¯»å–HTTPå¤´éƒ¨çš„è¶…æ—¶æ—¶é—´ï¼š<code>client_header_timeout timeï¼ˆé»˜è®¤å•ä½ï¼šç§’ï¼‰;</code></li>
<li>é»˜è®¤ï¼šclient_header_timeout 60;</li>
<li>è¯»å–HTTPåŒ…ä½“çš„è¶…æ—¶æ—¶é—´ï¼š<code>client_body_timeout timeï¼ˆé»˜è®¤å•ä½ï¼šç§’ï¼‰;</code></li>
<li>é»˜è®¤ï¼šclient_body_timeout 60;</li>
<li>å‘é€å“åº”çš„è¶…æ—¶æ—¶é—´ï¼š<code>send_timeout time;</code></li>
<li>é»˜è®¤ï¼šsend_timeout 60;</li>
<li><code>reset_timeout_connection on|off;</code></li>
<li>é»˜è®¤ï¼šreset_timeout_connection off;</li>
<li>
<p>è¿æ¥è¶…æ—¶ï¼Œç›´æ¥å‘ç”¨æˆ·å‘é€RSTé‡ç½®åŒ…ï¼Œè€Œä¸æ˜¯å››æ¬¡æŒ¥æ‰‹å…³é—­è¿æ¥ã€‚</p>
</li>
<li>
<p><code>lingering_close off|on|always;</code></p>
</li>
<li>é»˜è®¤ï¼šlingering_close on;</li>
<li>æ§åˆ¶Nginxå…³é—­ç”¨æˆ·è¿æ¥çš„æ–¹å¼ã€‚</li>
<li>alwaysè¡¨ç¤ºå…³é—­ç”¨æˆ·è¿æ¥å‰å¿…é¡»æ— æ¡ä»¶åœ°å¤„ç†è¿æ¥ä¸Šæ‰€æœ‰ç”¨æˆ·å‘é€çš„æ•°æ®</li>
<li>offè¡¨ç¤ºå…³é—­è¿æ¥æ—¶å®Œå…¨ä¸ç®¡è¿æ¥ä¸Šæ˜¯å¦å·²ç»æœ‰å‡†å¤‡å°±ç»ªçš„æ¥è‡ªç”¨æˆ·çš„æ•°æ®</li>
<li>
<p>onæ˜¯ä¸­é—´å€¼ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åœ¨å…³é—­è¿æ¥å‰éƒ½ä¼šå¤„ç†è¿æ¥ä¸Šçš„ç”¨æˆ·å‘é€çš„æ•°æ®</p>
</li>
<li>
<p><code>lingering_time time;</code>  </p>
</li>
<li>é»˜è®¤ï¼šlingering_time 30s;</li>
<li>
<p>è·Ÿç”¨æˆ·æ–‡ä»¶ä¸Šä¼ ç›¸å…³ï¼Œå¦‚æœç»è¿‡lingering_timeåï¼Œä¸Šä¼ è¿˜åœ¨ç»§ç»­ï¼Œåˆ™ä¼šå…³é—­è¿æ¥</p>
</li>
<li>
<p><code>lingering_timeout time;</code></p>
</li>
<li>é»˜è®¤ï¼šlingering_timeout 5s;</li>
<li>
<p>å…³é—­è¿æ¥å‰ï¼Œæ£€æµ‹æ˜¯å¦æœ‰ç”¨æˆ·å‘é€çš„æ•°æ®åˆ°è¾¾æœåŠ¡å™¨</p>
</li>
<li>
<p>å¯¹æŸäº›æµè§ˆå™¨ç¦ç”¨keepaliveåŠŸèƒ½ï¼š<code>keepalive_disable[msie6|safari|none]...</code></p>
</li>
<li>é»˜è®¤ï¼škeepalive_disablemsie6 safari</li>
<li>
<p>è®©å¤šä¸ªè¯·æ±‚å¤ç”¨ä¸€ä¸ªHTTPé•¿è¿æ¥ï¼Œè¿™ä¸ªåŠŸèƒ½å¯¹æœåŠ¡å™¨çš„æ€§èƒ½æé«˜æ˜¯å¾ˆæœ‰å¸®åŠ©çš„</p>
</li>
<li>
<p>keepaliveè¶…æ—¶æ—¶é—´ï¼š<code>keepalive_timeout timeï¼ˆé»˜è®¤å•ä½ï¼šç§’ï¼‰;</code></p>
</li>
<li>é»˜è®¤ï¼škeepalive_timeout 75;</li>
<li>
<p>ä¸€ä¸ªkeepaliveè¿æ¥åœ¨é—²ç½®è¶…è¿‡ä¸€å®šæ—¶é—´åï¼ˆé»˜è®¤çš„æ˜¯75ç§’ï¼‰ï¼ŒæœåŠ¡å™¨å’Œæµè§ˆå™¨éƒ½ä¼šå»å…³é—­è¿™ä¸ªè¿æ¥ã€‚</p>
</li>
<li>
<p>ä¸€ä¸ªkeepaliveé•¿è¿æ¥ä¸Šå…è®¸æ‰¿è½½çš„è¯·æ±‚æœ€å¤§æ•°ï¼š<code>keepalive_requests n;</code></p>
</li>
<li>
<p>é»˜è®¤ï¼škeepalive_requests 100;</p>
</li>
<li>
<p>å¯¹keepaliveè¿æ¥æ˜¯å¦ä½¿ç”¨TCP_NODELAYé€‰é¡¹ï¼š<code>tcp_nodelay on|off;</code></p>
</li>
<li>
<p>é»˜è®¤ï¼štcp_nodelay on;</p>
</li>
<li>
<p><code>tcp_nopush on|off;</code></p>
</li>
<li>é»˜è®¤ï¼štcp_nopush off;</li>
<li>æ‰“å¼€tcp_nopushåï¼Œå°†ä¼šåœ¨å‘é€å“åº”æ—¶æŠŠæ•´ä¸ªå“åº”åŒ…å¤´æ”¾åˆ°ä¸€ä¸ªTCPåŒ…ä¸­å‘é€</li>
</ul>
<h3 id="6mimeç±»å‹çš„è®¾ç½®">6.MIMEç±»å‹çš„è®¾ç½®<a class="headerlink" href="#6mimeç±»å‹çš„è®¾ç½®" title="Permanent link">ğŸŸ</a></h3>
<ul>
<li>
<p>MIME typeä¸æ–‡ä»¶æ‰©å±•çš„æ˜ å°„ï¼š<code>type{...};</code>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="nx">types</span> <span class="p">{</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a>  <span class="nx">text</span><span class="o">/</span><span class="nx">html</span> <span class="nx">html</span><span class="p">;</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a>  <span class="nx">text</span><span class="o">/</span><span class="nx">html</span> <span class="nx">conf</span><span class="p">;</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a>  <span class="nx">image</span><span class="o">/</span><span class="nx">gif</span> <span class="nx">gif</span><span class="p">;</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a>  <span class="nx">image</span><span class="o">/</span><span class="nx">jpeg</span> <span class="nx">jpg</span><span class="p">;</span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="p">}</span>
</code></pre></div></p>
</li>
<li>
<p>é»˜è®¤MIME typeï¼š<code>default_type MIME-type;</code></p>
</li>
<li>
<p>é»˜è®¤ï¼šdefault_type text/plain;</p>
</li>
<li>
<p><code>types_hash_bucket_size size;</code></p>
</li>
<li>é»˜è®¤ï¼štypes_hash_bucket_size 32|64|128;</li>
<li>
<p>è®¾ç½®æ¯ä¸ªæ•£åˆ—æ¡¶å ç”¨çš„å†…å­˜å¤§å°ï¼Œå¿«é€Ÿå¯»æ‰¾åˆ°ç›¸åº”MIME typeï¼Œä½¿ç”¨æ•£åˆ—è¡¨æ¥å­˜å‚¨MIMEtypeä¸æ–‡ä»¶æ‰©å±•å</p>
</li>
<li>
<p><code>types_hash_max_size size;</code></p>
</li>
<li>é»˜è®¤ï¼štypes_hash_max_size 1024;</li>
<li>types_hash_max_sizeè¶Šå¤§ï¼Œå°±ä¼šæ¶ˆè€—æ›´å¤šçš„å†…å­˜ï¼Œä½†æ•£åˆ—keyçš„å†²çªç‡ä¼šé™ä½ï¼Œæ£€ç´¢é€Ÿåº¦å°±æ›´å¿«</li>
</ul>
<h3 id="7å¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„é™åˆ¶">7.å¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„é™åˆ¶<a class="headerlink" href="#7å¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„é™åˆ¶" title="Permanent link">ğŸŸ</a></h3>
<ul>
<li>
<p>æŒ‰HTTPæ–¹æ³•åé™åˆ¶ç”¨æˆ·è¯·æ±‚ï¼š<code>limit_except method...{...}</code>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="c1"># ç¦æ­¢GETæ–¹æ³•å’ŒHEADæ–¹æ³•ï¼Œå…è®¸å…¶ä»–HTTPæ–¹æ³•</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a>limit_except GET <span class="o">{</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a>  allow <span class="m">192</span>.168.1.0/32<span class="p">;</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a>  deny all<span class="p">;</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="o">}</span>
</code></pre></div></p>
</li>
<li>
<p>HTTPè¯·æ±‚åŒ…ä½“çš„æœ€å¤§å€¼ï¼š<code>client_max_body_size size;</code></p>
</li>
<li>é»˜è®¤ï¼šclient_max_body_size 1m;</li>
<li>
<p>å¯ä»¥å‘Šè¯‰ç”¨æˆ·è¯·æ±‚è¿‡å¤§ä¸è¢«æ¥å—</p>
</li>
<li>
<p>å¯¹è¯·æ±‚çš„é™é€Ÿï¼š<code>limit_rate speed;</code></p>
</li>
<li>é»˜è®¤ï¼šlimit_rate 0;</li>
<li>
<p>é™åˆ¶æ¯ç§’ä¼ è¾“çš„å­—èŠ‚æ•°</p>
</li>
<li>
<p>è¶…è¿‡å¤šå¤§åé™é€Ÿï¼š<code>limit_rate_after time;</code></p>
</li>
<li>é»˜è®¤ï¼šlimit_rate_after 1m;   </li>
</ul>
<h3 id="8æ–‡ä»¶æ“ä½œçš„ä¼˜åŒ–">8.æ–‡ä»¶æ“ä½œçš„ä¼˜åŒ–<a class="headerlink" href="#8æ–‡ä»¶æ“ä½œçš„ä¼˜åŒ–" title="Permanent link">ğŸŸ</a></h3>
<ul>
<li>sendfileç³»ç»Ÿè°ƒç”¨ï¼š<code>sendfile on|off;</code></li>
<li>é»˜è®¤ï¼šsendfile off;</li>
<li>
<p>å‡å°‘å†…æ ¸æ€ä¸ç”¨æˆ·æ€é—´çš„æ–‡ä»¶å¤åˆ¶æ¬¡æ•°ï¼ˆé›¶æ‹·è´ï¼‰</p>
</li>
<li>
<p>AIOç³»ç»Ÿè°ƒç”¨ï¼š<code>aio on|off;</code></p>
</li>
<li>æ˜¯å¦åœ¨FreeBSDæˆ–Linuxç³»ç»Ÿä¸Šå¯ç”¨å†…æ ¸çº§åˆ«çš„å¼‚æ­¥æ–‡ä»¶I/OåŠŸèƒ½</li>
<li>
<p>ä¸sendfileåŠŸèƒ½æ˜¯äº’æ–¥çš„</p>
</li>
<li>
<p><code>directio size|off;</code></p>
</li>
<li>é»˜è®¤ï¼šdirectio off;</li>
<li>è¯»å–æ–‡ä»¶ï¼Œç¼“å†²åŒºå¤§å°ä¸ºsizeï¼Œé€šå¸¸å¯¹å¤§æ–‡ä»¶çš„è¯»å–é€Ÿåº¦æœ‰ä¼˜åŒ–ä½œç”¨ã€‚</li>
<li>
<p>ä¸sendfileåŠŸèƒ½æ˜¯äº’æ–¥çš„</p>
</li>
<li>
<p><code>directio_alignment size;</code></p>
</li>
<li>é»˜è®¤ï¼šdirectio_alignment 512;</li>
<li>
<p>ä¸directioé…åˆä½¿ç”¨ï¼ŒæŒ‡å®šä»¥directioæ–¹å¼è¯»å–æ–‡ä»¶æ—¶çš„å¯¹é½æ–¹å¼ï¼ˆ4kå¯¹é½ç­‰ï¼‰</p>
</li>
<li>
<p>æ‰“å¼€æ–‡ä»¶ç¼“å­˜ï¼š<code>open_file_cache max=N[inactive=time]|off;</code></p>
</li>
<li>
<p>é»˜è®¤ï¼šopen_file_cache off;</p>
</li>
<li>
<p>æ˜¯å¦ç¼“å­˜æ‰“å¼€æ–‡ä»¶é”™è¯¯çš„ä¿¡æ¯ï¼š<code>open_file_cache_errors on|off;</code></p>
</li>
<li>é»˜è®¤ï¼šopen_file_cache_errors off;</li>
<li>
<p>æ˜¯å¦åœ¨æ–‡ä»¶ç¼“å­˜ä¸­ç¼“å­˜æ‰“å¼€æ–‡ä»¶æ—¶å‡ºç°çš„æ‰¾ä¸åˆ°è·¯å¾„ã€æ²¡æœ‰æƒé™ç­‰é”™è¯¯ä¿¡æ¯</p>
</li>
<li>
<p>ä¸è¢«æ·˜æ±°çš„æœ€å°è®¿é—®æ¬¡æ•°ï¼š<code>open_file_cache_min_uses number;</code></p>
</li>
<li>é»˜è®¤ï¼šopen_file_cache_min_uses 1;</li>
<li>
<p>ä¸open_file_cacheä¸­çš„inactiveå‚æ•°é…åˆä½¿ç”¨ã€‚å¦‚æœåœ¨inactiveæŒ‡å®šçš„æ—¶é—´æ®µå†…ï¼Œè®¿é—®æ¬¡æ•°è¶…è¿‡äº†open_file_cache_min_usesæŒ‡å®šçš„æœ€å°æ¬¡æ•°ï¼Œé‚£ä¹ˆå°†ä¸ä¼šè¢«æ·˜æ±°å‡ºç¼“å­˜</p>
</li>
<li>
<p>æ£€éªŒç¼“å­˜ä¸­å…ƒç´ æœ‰æ•ˆæ€§çš„é¢‘ç‡ï¼š<code>open_file_cache_valid time;</code></p>
</li>
<li>é»˜è®¤ï¼šopen_file_cache_valid 60s;</li>
<li>é»˜è®¤ä¸ºæ¯60ç§’æ£€æŸ¥ä¸€æ¬¡ç¼“å­˜ä¸­çš„å…ƒç´ æ˜¯å¦ä»æœ‰æ•ˆ</li>
</ul>
<h3 id="9å¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„ç‰¹æ®Šå¤„ç†">9.å¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„ç‰¹æ®Šå¤„ç†<a class="headerlink" href="#9å¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„ç‰¹æ®Šå¤„ç†" title="Permanent link">ğŸŸ</a></h3>
<ul>
<li>å¿½ç•¥ä¸åˆæ³•çš„HTTPå¤´éƒ¨ï¼š<code>ignore_invalid_headers on|off;</code></li>
<li>é»˜è®¤ï¼šignore_invalid_headers off;</li>
<li>
<p>offè¡¨ç¤ºå…è®¸ä¸åˆæ³•çš„è¯·æ±‚å¤´</p>
</li>
<li>
<p>HTTPå¤´éƒ¨æ˜¯å¦å…è®¸ä¸‹åˆ’çº¿ï¼š<code>underscores_in_headers on|off;</code></p>
</li>
<li>é»˜è®¤ï¼šunderscores_in_headers off;</li>
<li>
<p>offè¡¨ç¤ºä¸å…è®¸æœ‰ä¸‹åˆ’çº¿</p>
</li>
<li>
<p>å¯¹If-Modified-Sinceå¤´éƒ¨çš„å¤„ç†ç­–ç•¥ï¼š<code>if_modified_since[off|exact|before];</code></p>
</li>
<li>é»˜è®¤ï¼šif_modified_since exact;</li>
<li>
<p>ä¸Šæ¬¡è¯·æ±‚è·å–å†…å®¹çš„æ—¶é—´</p>
</li>
<li>
<p>æ–‡ä»¶æœªæ‰¾åˆ°æ—¶æ˜¯å¦è®°å½•åˆ°erroræ—¥å¿—ï¼š<code>log_not_found on|off;</code></p>
</li>
<li>
<p>é»˜è®¤ï¼šlog_not_found on;</p>
</li>
<li>
<p>åˆå¹¶è¯·æ±‚ä¸­ç›¸é‚»çš„/ï¼š<code>merge_slashes on|off;</code></p>
</li>
<li>
<p>é»˜è®¤ï¼šmerge_slashes on;</p>
</li>
<li>
<p>DNSè§£æåœ°å€ï¼š<code>resolver address...;</code></p>
</li>
<li>DNSè§£æçš„è¶…æ—¶æ—¶é—´ï¼š<code>resolver_timeout time;</code></li>
<li>é»˜è®¤ï¼šresolver_timeout 30s;</li>
</ul>

<!-- Source file information -->

  <!--
  Copyright (c) 2016-2021 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Source file information -->
<hr />
<div class="md-source-file">
  <small>

    <!-- mkdocs-git-revision-date-localized-plugin -->
    
      æœ€åæ›´æ–°:
      2021-12-25
    
  </small>
</div>


<!-- Get setting from mkdocs.yml, but allow page-level overrides -->



<!-- Inject Disqus into current page -->

    <div id="vssue"></div>

    <!--<link rel="stylesheet" href="https://unpkg.com/vssue/dist/vssue.min.css">
 OR: vue full build (runtime + compiler)  -->
<script src="https://unpkg.com/vue/dist/vue.min.js"></script>
<!-- Vssue Github build -->
<script src="https://unpkg.com/vssue/dist/vssue.github.min.js"></script>

<script>
    new Vue({
      el: '#vssue',
   
      data: {
        title: options => `${options.prefix}${document.title}`,
        
        options: {
          owner: 'shafishcn',
          repo: 'shafish_blog',
          clientId: 'f1ccfedcce534122af88',//'f49fcb8c02a7868c8690',//
          clientSecret: '1c301b1dd2616bfa68853a8c27684fd069b97dcd',//'5940fc487ff4e7237a01a28c0fe3775140bf05b2', // only required for some of the platforms
          prefix: '[BlogComment]',
          labels: [':sunny:'],
          issueContent: ({ url }) =>`è¿™ä¸ª Issue ç”± Vssue è‡ªåŠ¨åˆ›å»ºï¼Œç”¨æ¥å­˜å‚¨è¯¥é¡µé¢çš„è¯„è®ºï¼š${url}`
        },
      },

      template: `<vssue :title="title" :options="options"></vssue>`,
    })
</script>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            å›åˆ°é¡µé¢é¡¶éƒ¨
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="é¡µè„š">
      
        
        <a href="../github_action/" class="md-footer__link md-footer__link--prev" aria-label="ä¸Šä¸€é¡µ: github actionä½¿ç”¨" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                ä¸Šä¸€é¡µ
              </span>
              github actionä½¿ç”¨
            </div>
          </div>
        </a>
      
      
        
        <a href="../../../../life/" class="md-footer__link md-footer__link--next" aria-label="ä¸‹ä¸€é¡µ: ç”Ÿæ´»" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                ä¸‹ä¸€é¡µ
              </span>
              ç”Ÿæ´»
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2018 - 2021 shafish
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="mailto:<shafish_cn@163.com>" target="_blank" rel="noopener" title="å‘é€é‚®ä»¶" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M476 3.2 12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tracking", "navigation.tabs", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.top", "search.suggest", "search.highlight", "content.code.annotate", "header.autohide", "toc.separate"], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "search": "../../../../assets/javascripts/workers/search.0bbba5b5.min.js"}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.e1a181d9.min.js"></script>
      
        <script src="../../../../javascripts/extra.js"></script>
      
    
  </body>
</html>